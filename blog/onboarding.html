<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <title>Marcos Tanaka - blog</title>

    <!-- Bootstrap core CSS -->
    <link href="../vendors/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../resources/css/common.css" rel="stylesheet">
    <link href="../resources/css/navbar.css" rel="stylesheet">
    <link href="../resources/css/jumbotron.css" rel="stylesheet">
    <link href="../resources/css/blog.css" rel="stylesheet">
  </head>

  <body>

    <div class="cover-container d-flex h-100 p-3 mx-auto flex-column">
      <header class="masthead mb-auto">
        <div class="inner">
          <nav class="nav nav-masthead justify-content-center">
            <a class="nav-link" href="../index.html">about</a>
            <a class="nav-link" href="../work.html">work</a>
            <a class="nav-link" href="../contact.html">contact</a>
            <a class="nav-link active" href="../blog.html">blog</a>
          </nav>
        </div>
      </header>
    </div>

    <main role="main">

      <section class="jumbotron text-center">
        <div class="container blog">
          <h1 class="jumbotron-heading">Criando onboarding com UICollectionView e Storyboard</h1>
        </div>
      </section>

      <div class="py-5 bg-light">
        <div class="container">

          <div class="row ">
            
            <div class="col-md-10 offset-md-1">
              <div class="card mb-6 box-shadow">
                <img class="card-img-top" src="../resources/images/blog/onboarding/0.png" alt="kiwi queue">
                <div class="card-body">
                  <p class="lead text-muted small">Escrito em 28/07/2018 ~ √öltima atualiza√ß√£o 07/08/2018</p>

                  <p>Sabe aquelas telas de boas vindas que vemos quando abrimos um app pela primeira vez? Este processo √© feito para familiarizar o usu√°rio com o app e suas fun√ß√µes. √â uma oportunidade para apresentar as principais funcionalidades ou diferenciais do app, novidades de uma vers√£o, ou tentar convencer usu√°rios a se registrarem no servi√ßo.</p>

                  <p>Neste tutorial irei ensinar como criar um onboarding com <code>UICollectionView</code>, desenhado no Storyboard. Os controllers das views ser√£o escritos em Swift 4. Se quiser baixar o projeto completo, <a href="https://github.com/marcosatanaka/onboarding-ios">siga este link para o GitHub</a>.</p>

                  <h2>Storyboard</h2>

                  <p>Acho legal usar o storyboard pra desenhar as views porque economiza muito tempo e linhas de c√≥digo üòå, fora a vantagem de poder ver todo o fluxo de telas da aplica√ß√£o de uma vez!</p>

                  <p>Por isso, vamos criar um novo projeto, abrir o storyboard, remover a View Controller padr√£o e colocar em seu lugar uma Collection View Controller. Com a ajuda do <em>Document Outline</em>, selecione a Collection View que est√° dentro da Collection View Controller. Queremos alterar algumas propriedades para que ela se comporte como um omboarding com scroll horizontal:</p>
                  
                  <img class="post-img" src="../resources/images/blog/onboarding/1.png" alt="">

                  <p>Al√©m disso, vamos desmarcar as propriedades <em>Show Horizontal Indicator</em> e <em>Show Vertical Indicator</em> para que as barras de rolagem n√£o apare√ßam. Desmarque tamb√©m <em>Bounce On Scroll</em> e <em>Bounce On Zoom</em>, para que n√£o ocorra o efeito de bounce ao fazer o scroll. E tamb√©m marque a op√ß√£o <em>Paging Enabled</em>, para que o scroll n√£o pare entre uma p√°gina e outra.</p>

                  <p>Por fim, ainda no painel <em>Utilities</em>, na aba <em>Size inspector</em>, vamos alterar as propriedades <em>Min Spacing For Cells</em> e <em>Min Spacing For Lines</em> para 0. Isto far√° qua n√£o haja espa√ßo entre as c√©lulas, para que cada uma ocupe de fato a tela inteira (este tamanho vamos definir em c√≥digo mais adiante üë®‚Äçüíª).</p>
                  
                  <p>A propriedade <em>Items</em> da Collection View controla quantas c√©lulas ela possui. Neste onboarding faremos com que a c√©lula ocupe a tela inteira. Assim, Items dir√° quantas p√°ginas vamos ter no onboarding.</p>
                  
                  <p>Vamos agora desenhar o prot√≥tipo da c√©lula da Collection View. Todas as c√©lulas seguir√£o este prot√≥tipo, mudaremos apenas as informa√ß√µes de cada uma. O pequeno quadrado no canto superior esquerdo da Collection View (üî¨) √© o prot√≥tipo da c√©lula. Dentro dele ficar√£o os componentes visuais que comp√µem o prot√≥tipo. Para conseguirmos posicion√°-los, aumente o tamanho da c√©lula (n√£o se preocupe com o tamanho real, pois definiremos isso programaticamente para preencher a tela inteira).</p>
                  
                  <p>O layout ser√° uma Image View no topo, com dois Labels em baixo e um Button. Para diminuir o n√∫mero de Constraints, empilharemos tudo em uma Stack View vertical:</p>
                  
                  <img class="post-img" src="../resources/images/blog/onboarding/2.png" alt="">
                  
                  <p>Vamos configurar a Stack View para ter <em>Distribution: Equal Centering</em> e <em>Spacing: Standard</em>. Depois, centraliz√°-la e definir a largura de 260px usando constraints.</p>
                  
                  <img class="post-img" src="../resources/images/blog/onboarding/3.png" alt="">
                  
                  <p>Para os Labels dentro da Stack View, defina a propriedade <em>Lines: 0</em> para que textos maiores quebrem a linha automaticamente. O primeiro label ser√° o t√≠tulo, ent√£o usaremos a fonte com <em>Style: Bold</em> e <em>Size: 24px</em>.</p>
                  
                  <p>Para a Image View, vamos adicionar uma constraint de altura fixa 120px. Al√©m disso, o <em>Content Mode</em> ser√° <em>Aspect Fit</em>.</p>
                  
                  <p>E o Button ter√° a constraint de altura e largura fixos. A largura ser√° >= 260px, e a altura ser√° 40px. Assim ele ocupa a largura inteira da Stack View.</p>

                  <h2>C√≥digo</h2>
                  
                  <p>Vamos agora escrever as classes por tr√°s das views que desenhamos no storyboard. Precisaremos das seguintes:</p>

                  <ul>
                    <li><code>OnboardingCollectionViewController</code>: respons√°vel pela Collection View - data source e delegate.</li>
                    <li><code>OnboardingCollectionViewCell</code>: respons√°vel por preencher os dados de cada c√©lula da Collection View.</li>
                    <li><code>OnboardingModel</code>: struct que define a estrutura dos dados apresentados no onboarding.</li>
                    <li><code>OnboardingModelFactory</code>: para facilitar a instancia√ß√£o dos modelos que ser√£o usados no onboarding.</li>
                  </ul>

                  <p>Seguem abaixo:</p>

                  <script src="https://gist.github.com/marcosatanaka/64947b33445deb0a92b71ce25ec7844f.js"></script>

                  <script src="https://gist.github.com/marcosatanaka/3a5dcdf41a8424824c8c6483b92ef15d.js"></script>

                  <script src="https://gist.github.com/marcosatanaka/6bc26049b603c6c256bdecd0a4fbd7ee.js"></script>

                  <script src="https://gist.github.com/marcosatanaka/0681de450861592b54f214c06a28ebad.js"></script>

                  <h3>UICollectionViewController</h3>
                  
                  <p>Depois de criar os arquivos, volte para o storyboard e defina as classes da Collection View Controller e da Collection View Cell. Al√©m disso, defina o <em>Reuse Identifier</em> da c√©lula como "OnboardingCell" (painel <em>Utilities</em>, na aba <em>Attributes inspector</em>).</p>
                  
                  <p>Vamos agora implementar os m√©todos da classe <code>OnboardingCollectionViewController</code>. Nela definiremos a quantidade de p√°ginas do onboarding, as informa√ß√µes de cada p√°gina, o tamanho (tela inteira), e tamb√©m colocaremos um <code>UIPageControl</code> para indicar ao usu√°rio qual p√°gina ele est√° atualmente.</p>

                  <script src="https://gist.github.com/marcosatanaka/c034761abb1873b6d2dc30710058d5a8.js"></script>
                  
                  <p>Usando a factory criada anteriormente, instanciamos os conte√∫dos das tr√™s p√°ginas de onboarding e colocamos na constante pages. Ela √© a fonte de dados que alimenta a Collection View. Criamos tamb√©m um <code>UIPageControl</code> e adicionamos programaticamente na view, definindo as constraints no m√©todo <code>ddPageControlToView()</code>.</p>

                  <p>O tamanho de cada c√©lula da Collection View √© definido no m√©todo <code>collectionView(_:layout:sizeForItemAt:)</code>. O tamanho ser√° igual ao tamanho da Collection View, ou seja, a tela inteira.</p>

                  <p>O <code>UIPageControl</code> √© atualizado no m√©todo <code>scrollViewWillEndDragging(_:withVelocity:targetContentOffset:)</code>.</p>

                  <h3>UICollectionViewCell</h3>

                  <p>A <code>OnboardingCollectionViewCell</code> tem refer√™ncia para os componentes de cada c√©lula, e um m√©todo respons√°vel por preencher essas refer√™ncias com os dados:</p>
                  
                  <img class="post-img" src="../resources/images/blog/onboarding/4.png" alt="">

                  <p>Definimos tamb√©m uma constante est√°tica para o reuse identifier da c√©lula (o mesmo definido no storyboard). Vamos usar essa constante no view controller, para referenciar a c√©lula que ser√° reaproveitada. A classe final ficar√° assim:</p>

                  <script src="https://gist.github.com/marcosatanaka/d0385ee70c2762512f2d5957ab18496f.js"></script>

                  <p>Perceba tamb√©m que as primeiras instru√ß√µes do m√©todo <code>fill</code> definem a cor de background da c√©lula com base no <code>OnboardingModel</code> recebido.</p>

                  <h3>Resources</h3>

                  <p>O √∫ltimo passo √© definir os resources usados em cada p√°gina. Basta editar o arquivo <code>Assets.xcassets</code>, dar um nome para cada recurso e arrastar as imagens para os respectivos slots:</p>
                  
                  <img class="post-img" src="../resources/images/blog/onboarding/5.png" alt="">

                  <p>Obs.: em um projeto real voc√™ vai querer definir as imagens para as resolu√ß√µes 1x, 2x e 3x, para que a correta seja utilizada conforme a densidade de pixels do aparelho. Para facilitar este exemplo, estou usando uma imagem √∫nica para as tr√™s densidades üòù</p>

                  <h3>Alguns detalhes</h3>

                  <p>Fora o que est√° descrito aqui, melhorei alguns outros detalhes como o espa√ßamento entre a imagem e os textos, alguns detalhes do bot√£o, e a organiza√ß√£o dos arquivos do projeto. A ideia √© que ele leve √† view inicial do app, ou para o login. Recomendo baixar o projeto do GitHub para ver como ficou o resultado final.</p>

                  <p>Conforme novas vers√µes do iOS e do Swift forem saindo, irei atualizar este tutorial para acompanhar as novidades. E gostaria tamb√©m de receber sugest√µes de melhorias neste esquema ou formas melhores de criar onboarding no iOS, portanto, se tiver alguma sugest√£o, n√£o hesite em compartilhar! üòâ</p>
                  
                  <span class="badge badge-pill badge-light">Swift</span>
                  <span class="badge badge-pill badge-light">UICollectionView</span>
                  <span class="badge badge-pill badge-light">Storyboard</span>
                  <span class="badge badge-pill badge-light">Onboard</span>
                  <span class="badge badge-pill badge-light">Tutorial</span>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>

    </main>

    <footer class="text-muted">
      <div class="container">
        <p class="float-right">
          <a href="#">back to top</a>
        </p>
        <p></p>
      </div>
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="vendors/popper.min.js"></script>
    <script src="vendors/bootstrap.min.js"></script>
  </body>
</html>

<!-- Album template for Bootstrap -->
